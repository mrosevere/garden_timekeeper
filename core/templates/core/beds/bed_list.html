{% extends "core/base.html" %}
{% block content %}

<!-- PAGE HEADER -->
<div class="container py-2">
  <div class="d-flex flex-column flex-sm-row justify-content-between align-items-center mb-4 text-center text-sm-start">

    <h1 class="h3 mb-3 px-2">Garden Beds</h1>

    <div>
      <a href="{% url 'bed_create' %}" class="btn btn-primary">
        Add Bed
      </a>
    </div>

  </div>
</div>

<!-- ======================================================== -->
<!-- Mobile Card View (shown below md) -->
<!-- ======================================================== -->
<div class="d-block d-md-none container mb-4">
  <div class="row g-3">

    {% for bed in object_list %}
    <div class="col-12">

      <div class="card shadow-sm">

        <!-- Card Header -->
        <div class="card-header d-flex justify-content-between align-items-center">
          <h5 class="mb-0">
            <a href="{% url 'bed_detail' bed.pk %}">
              {{ bed.name }}
            </a>
          </h5>
        </div>

        <!-- Card Body -->
        <div class="card-body">

          <div class="mb-2">
            <strong>Location:</strong>
            {{ bed.location|default:"—" }}
          </div>

          <div class="mb-2">
            <strong>Created:</strong>
            {{ bed.created_at|date:"Y-m-d" }}
          </div>

        </div>

        <!-- Card Footer -->
        <div class="card-footer d-flex justify-content-end gap-2">

          <a href="{% url 'bed_edit' bed.pk %}"
             class="btn btn-sm btn-primary" style="min-width: 60px;">
            Edit
          </a>

          <button class="btn btn-sm btn-danger"
                  data-bs-toggle="modal"
                  data-bs-target="#deleteModal-{{ bed.pk }}">
            Delete
          </button>

        </div>

      </div>
    </div>

    {% empty %}
    <div class="col-12">
      <div class="card shadow-sm">
        <div class="card-body text-center text-muted">
          You don’t have any garden beds yet.
        </div>
      </div>
    </div>
    {% endfor %}

  </div>
</div>

<!-- ======================================================== -->
<!-- Desktop Table View (shown md and above) -->
<!-- ======================================================== -->
<div class="d-none d-md-block">
  <div class="container mb-4">

    {% if object_list %}
    <div class="table-responsive">
      <table class="table table-striped table-hover align-middle">

        <thead>
          <tr>

            <!-- Name -->
            <th>Name</th>

            <!-- Location -->
            <th>Location</th>

            <!-- Created -->
            <th>Created</th>

            <!-- Actions -->
            <th class="text-end">Actions</th>

          </tr>
        </thead>

        <tbody>
          {% for bed in object_list %}
          <tr>

            <td>
              <a href="{% url 'bed_detail' bed.pk %}">
                {{ bed.name }}
              </a>
            </td>

            <td>{{ bed.location|default:"—" }}</td>

            <td>{{ bed.created_at|date:"Y-m-d" }}</td>

            <td class="text-end">
              <a href="{% url 'bed_edit' bed.pk %}"
                 class="btn btn-sm btn-primary me-2" style="min-width: 60px;">
                Edit
              </a>

              <button class="btn btn-sm btn-danger"
                      data-bs-toggle="modal"
                      data-bs-target="#deleteModal-{{ bed.pk }}">
                Delete
              </button>
            </td>

          </tr>
          {% endfor %}
        </tbody>

      </table>
    </div>

    {% else %}
      <p class="text-center text-muted py-4">
        You don’t have any garden beds yet.
      </p>
    {% endif %}

  </div>
</div>

<!-- ======================================================== -->
<!-- Delete Modals -->
<!-- ======================================================== -->
{% for bed in object_list %}
<div class="modal fade" id="deleteModal-{{ bed.pk }}" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title">Delete Garden Bed</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body">
        Are you sure you want to delete <strong>{{ bed.name }}</strong>?
      </div>

      <div class="modal-footer">
        <form method="post" action="{% url 'bed_delete' bed.pk %}">
          {% csrf_token %}
          <button type="submit" class="btn btn-danger">
            Yes, delete
          </button>
        </form>

        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          Cancel
        </button>
      </div>

    </div>
  </div>
</div>
{% endfor %}

{% endblock %}
